var e={241:(e,t,i)=>{i.r(t),i.d(t,{openFilter:()=>n,saveAsFilter:()=>s,exportFilter:()=>a});const n=[{value:"md",text:"Markdown (*.md, *.markdown)",exts:[".md",".markdown"],mime:"text/markdown"},{value:"html",text:"HTML (*.html, *.htm)",exts:[".html",".htm"],mime:"text/html"},{value:"*",text:"All Files (*.*)",exts:[],mime:"*/*"}],s=[{value:"md",text:"Markdown (*.md, *.markdown)",exts:[".md",".markdown"],mime:"text/markdown"},{value:"*",text:"All Files (*.*)",exts:[],mime:"*/*"}],a=[].concat(window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER?[]:[{value:"pdf",text:"PDF (*.pdf)",exts:[".pdf"],mime:"application/pdf"}],[{value:"html",text:"HTML (*.html, *.htm)",exts:[".html",".htm"],mime:"text/html"},{value:"*",text:"All Files (*.*)",exts:[],mime:"*/*"}])}},t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={};i.r(e),i.d(e,{carlo:()=>L,fileExists:()=>$,getBaseName:()=>O,getDirName:()=>_,getStartupFile:()=>I,listDesktopDirectory:()=>R,listDirectory:()=>F,listHomeDirectory:()=>N,loadFile:()=>E,nativeAlert:()=>C,nativeAlertSync:()=>x,nativeConfirm:()=>S,nativeConfirmSync:()=>b,nativeFileOpenDialog:()=>k,nativeFileSaveDialog:()=>A,nativeNotifyEditorDirty:()=>v,openNewWindow:()=>W,openURL:()=>B,pathJoin:()=>T,renderByMenneu:()=>D,rpc:()=>j,saveFile:()=>P});var t={};i.r(t),i.d(t,{carlo:()=>Ne,fileExists:()=>be,getBaseName:()=>De,getDirName:()=>Ae,getStartupFile:()=>Ee,listDesktopDirectory:()=>xe,listDirectory:()=>Ce,listHomeDirectory:()=>Se,loadFile:()=>ye,nativeAlert:()=>he,nativeAlertSync:()=>ue,nativeConfirm:()=>me,nativeConfirmSync:()=>pe,nativeFileOpenDialog:()=>fe,nativeFileSaveDialog:()=>ge,nativeNotifyEditorDirty:()=>de,openNewWindow:()=>Fe,openURL:()=>Pe,pathJoin:()=>ke,renderByMenneu:()=>we,rpc:()=>Re,saveFile:()=>ve});var n={};let s,a,r,o,l,c,d,h,u,m,p,f,g,w,y;i.r(n),i.d(n,{carlo:()=>yt,fileExists:()=>dt,getBaseName:()=>mt,getDirName:()=>ut,getStartupFile:()=>pt,listDesktopDirectory:()=>lt,listDirectory:()=>ot,listHomeDirectory:()=>ct,loadFile:()=>at,nativeAlert:()=>Qe,nativeAlertSync:()=>Ze,nativeConfirm:()=>et,nativeConfirmSync:()=>tt,nativeFileOpenDialog:()=>it,nativeFileSaveDialog:()=>nt,nativeNotifyEditorDirty:()=>Xe,openNewWindow:()=>gt,openURL:()=>ft,pathJoin:()=>ht,renderByMenneu:()=>st,rpc:()=>wt,saveFile:()=>rt}),"CARLO_RPC"===window._MDNE_BACKEND_TYPE&&(window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER=!1,window._MDNE_BACKEND_CAPS_NO_PDF_PREVIEW_PLUGIN=!1,s=window.renderByMenneu,a=window.loadFile,r=window.saveFile,o=window.listDirectory,l=window.listDesktopDirectory,c=window.listHomeDirectory,d=window.fileExists,h=window.pathJoin,u=window.getDirName,m=window.getBaseName,p=window.getStartupFile,f=window.openURL,g=window.openNewWindow,w=window.rpc,y=window.carlo);const v=undefined,C=undefined,x=undefined,S=undefined,b=undefined,k=undefined,A=undefined,D=s,E=a,P=r,F=o,R=l,N=c,$=d,T=h,_=u,O=m,I=p,B=f,W=g,j=w,L=y;let z,U,q,H,K,Y,V,G,J,X,Q,Z,ee,te,ie,ne,se,ae,re,oe,le,ce;if("ELECTRON_IPC"===window._MDNE_BACKEND_TYPE){const e=mdneApi.getKey();window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER=!1,window._MDNE_BACKEND_CAPS_NO_PDF_PREVIEW_PLUGIN=!1,z=t=>{mdneApi.send(e,"app:editor:notifyEditorDirty",{dirty:t})},U=async(t,i)=>await mdneApi.ipc(e,"app:editor:nativeAlert",{message:t,type:i}),q=(t,i)=>mdneApi.ipcSync(e,"app:editor:nativeAlertSync",{message:t,type:i}),H=async(t,i)=>await mdneApi.ipc(e,"app:editor:nativeConfirm",{message:t,type:i}),K=(t,i)=>mdneApi.ipcSync(e,"app:editor:nativeConfirmSync",{message:t,type:i}),Y=async(t,i,n)=>await mdneApi.ipc(e,"app:editor:nativeFileOpenDialog",{title:t,defaultPath:i,filters:n}),V=async(t,i,n,s)=>await mdneApi.ipc(e,"app:editor:nativeFileSaveDialog",{title:t,defaultPath:i,filters:n}),G=async(t,i,n,s,...a)=>await mdneApi.ipc(e,"app:editor:renderByMenneu",{source:t,data:i,options:n,srcPath:s,exportPath:a}),J=async(...t)=>await mdneApi.ipc(e,"app:editor:loadFile",{filePath:t}),X=async(t,...i)=>await mdneApi.ipc(e,"app:editor:saveFile",{text:t,filePath:i}),Q=async(...t)=>await mdneApi.ipc(e,"app:editor:listDirectory",{dirPath:t}),Z=async()=>await mdneApi.ipc(e,"app:editor:listDesktopDirectory",{}),ee=async()=>await mdneApi.ipc(e,"app:editor:listHomeDirectory",{}),te=async(...t)=>await mdneApi.ipc(e,"app:editor:fileExists",{filePath:t}),ie=async(...t)=>await mdneApi.ipc(e,"app:editor:pathJoin",{filePath:t}),ne=async t=>await mdneApi.ipc(e,"app:editor:getDirName",{filePath:t}),se=async t=>await mdneApi.ipc(e,"app:editor:getBaseName",{filePath:t}),ae=async()=>await mdneApi.ipc(e,"app:editor:getStartupFile",{}),re=async t=>await mdneApi.ipc(e,"app:editor:openURL",{url:t}),oe=async()=>await mdneApi.ipc(e,"app:editor:openNewWindow",{});class t{async setFrontend(e){this.frontend_=e,(async()=>{})()}async runCommand(t){return await mdneApi.ipc(e,"app:editor:Backend:runCommand",{command:t})}async runCommandAST(t){return await mdneApi.ipc(e,"app:editor:Backend:runCommandAST",{ast:t})}}const i=new t;le={handle:e=>e},ce={loadParams:async()=>[i],fileInfo:async e=>({path:e.path,fileBodyText:await ye(e.path)})},mdneApi.on(e,"app:editor:Frontend:runCommand",(async(e,t)=>{try{let n=i.frontend_.runCommand(t.command);n instanceof Promise&&(n=await n),e.sender.send("app:editor:Frontend:runCommand",{succeeded:!0,payload:n})}catch(t){e.sender.send("app:editor:Frontend:runCommand",{succeeded:!1,error:t.message})}})),document.addEventListener("keyup",(t=>{122===t.keyCode&&(mdneApi.ipc(e,"app:editor:toggleFullScreen",{}),t.preventDefault())}),!1)}const de=z,he=U,ue=q,me=H,pe=K,fe=Y,ge=V,we=G,ye=J,ve=X,Ce=Q,xe=Z,Se=ee,be=te,ke=ie,Ae=ne,De=se,Ee=ae,Pe=re,Fe=oe,Re=le,Ne=ce;let $e,Te,_e,Oe,Me,Ie,Be,We,je,Le,ze,Ue,qe,He,Ke,Ye,Ve;function Ge(e){return e.filter((e=>e.extensions.length&&"*"!==e.extensions[0])).map((e=>({description:e.name,accept:{[e.mime]:e.extensions.map((e=>`.${e}`))}})))}if(!window._MDNE_BACKEND_TYPE||"BROWSER_EMULATION"===window._MDNE_BACKEND_TYPE){window._MDNE_BACKEND_TYPE="BROWSER_EMULATION",window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER=!0,window._MDNE_BACKEND_CAPS_NO_PDF_PREVIEW_PLUGIN=!0;const e="assets/data/welcome.md";let t=null,n=null;async function Je(e,s,...a){let r=await ht(...a),o=await mt(r);const l=menneu.getAppEnv().RedAgateUtil,c=await Promise.resolve().then(i.bind(i,241));let d=e?n:t,h=!1;if(window.showSaveFilePicker){if(!d){const i=await nt("","",c.saveAsFilter.map((e=>({name:e.text,extensions:e.exts&&e.exts.length>0?e.exts.map((e=>e.slice(1))):["*"],mime:e.mime}))),e?"export":"saveas");d=e?n:t,d&&i&&(r=o=i)}if(d){const e=await d.createWritable();await e.write(s),await e.close(),h=!0}e&&(n=null)}if(h||await l.FileSaver.saveTextAs(o,s),!e)try{window.location.hash=`filename=${encodeURIComponent(o)}&open.d=${l.Base64.encode(pako.deflate(l.TextEncoding.encodeToUtf8(s))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}`}catch(e){}return{path:r,name:o}}window.showOpenFilePicker&&($e=async(e,i,n)=>{try{const[e]=await window.showOpenFilePicker({types:Ge(n)});return t=e,[(await t.getFile()).name]}catch(e){return}}),window.showSaveFilePicker&&(Te=async(e,i,s,a)=>{try{const e=await window.showSaveFilePicker({types:Ge(s)}),i=await e.getFile();switch(a){case"saveas":t=e;break;case"export":n=e}return i.name}catch(e){return}}),_e=async(e,t,i,n,...s)=>{const a=Object.assign({},i,{replacementMacros:[{re:/!!!lsx\s([\s\S]+?)!!!/g,fn:"lsx"}].concat(window.Vx02PGUB3NFWwhsd__replacementMacros&&Array.isArray(window.Vx02PGUB3NFWwhsd__replacementMacros)?window.Vx02PGUB3NFWwhsd__replacementMacros:[])});if(!a.outputFormat||"html"!==a.outputFormat.toLowerCase()){const e=`output format ${a.outputFormat} is not available.`;throw new Error(e)}let r=(await menneu.render(e,{},a)).toString();0===s.length&&(r+="\n<style>\n::-webkit-scrollbar {\n    width: 13px;\n    height: 13px;\n}\n::-webkit-scrollbar-track {\n    border-style: solid;\n    border-width: 1px;\n    border-color: rgb(88, 88, 88);\n    background-color: rgb(56, 56, 56);\n}\n::-webkit-scrollbar-thumb {\n    border-style: solid;\n    border-width: 1px;\n    border-color: rgb(88, 88, 88);\n    background-color: rgb(102, 102, 102);\n}\n</style>\n");const o=URL.createObjectURL(new Blob([r],{type:"text/html"}));return s.length>0&&Je(!0,r,...s),setTimeout((()=>URL.revokeObjectURL(o)),5e3),o},Oe=async(...i)=>{if(t){const e=await t.getFile();return await e.text()}{const t=await fetch(e);return await t.text()}},Me=async(e,...t)=>await Je(!1,e,...t),Ie=async(...e)=>({directory:"",files:[{name:".",isDirectory:!0}]}),Be=async()=>({directory:"/",files:[{name:".",isDirectory:!0}]}),We=async()=>({directory:"/",files:[{name:".",isDirectory:!0}]}),je=async(...e)=>!1,Le=async(...e)=>{const t=e.filter((e=>e.length>0)).join("/").replace(/\/+/g,"/"),i=t.split("/"),n=[];for(const e of i)switch(e){case".":case"":break;case"..":n.pop();break;default:e.match(/^[.]+$/)?n.pop():n.push(e)}return(t.startsWith("/")?"/":"")+n.join("/")},ze=async e=>{let t=e;return t=-1!==t.lastIndexOf("/")?t.substring(0,t.lastIndexOf("/")):"",t},Ue=async e=>e.substring(e.lastIndexOf("/")+1),qe=async()=>{let t="Welcome.md",i=e;const n=menneu.getAppEnv().RedAgateUtil;if(window.location.hash){const e={};if(window.location.hash.substring(1).split("&").forEach((t=>{const i=t.split("=");e[i[0]]=decodeURIComponent(i[1])})),window.location.hash.indexOf("open.d=")>=0){if(e["open.d"]){t=e.filename||"Untitled.md";try{i=`data:text/plain;base64,${n.Base64.encode(pako.inflate(n.Base64.decode(e["open.d"].replace(/-/g,"+").replace(/_/g,"/"))))}`}catch(e){}}}else window.location.hash.indexOf("open.url=")>=0?e["open.url"]&&(t=e["open.url"].substring(e["open.url"].lastIndexOf("/")+1)||"index",i=e["open.url"]):e.filename&&(t=e.filename,i="data:text/plain,")}const s=await fetch(i,{});if(s.ok)return{path:t,text:await s.text()};throw new Error("Fetching url failed. Network response was not ok, or CORB error.")},He=async e=>(window.open(e,"_blank","noopener"),!0),Ke=async()=>(window.open(window.location.pathname+"#filename=Untitled.md","_blank","noopener"),!0);const s=(()=>{let e=Object.assign({},liyad.defaultConfig);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),e=liyad.installCore(e),e=liyad.installArithmetic(e),e=liyad.installSequence(e),e=liyad.installConcurrent(e),e.stripComments=!0,e.returnMultipleRoot=!0,liyad.SExpressionAsync(e)})();s.setGlobals({}).install((e=>{const t=[{name:"$>",fn:(e,t)=>(...e)=>new Promise(((e,t)=>{t(new Error("cannot execute shell"))}))}];return e.funcs=(e.funcs||[]).concat(t),e}));class a{async setFrontend(e){this.frontend_=e,(async()=>{})()}async runCommand(e){return s(e)}async runCommandAST(e){return s.evaluateAST(e)}}const r=new a;Ye={handle:e=>e},Ve={loadParams:async()=>[r],fileInfo:async e=>new Promise(((i,n)=>{t=null;const s=new FileReader;s.onload=t=>{i({path:e.name,fileBodyText:s.result})},s.onerror=e=>{n(s.error)},s.readAsText(e,"UTF-8")}))}}const Xe=undefined,Qe=undefined,Ze=undefined,et=undefined,tt=undefined,it=$e,nt=Te,st=_e,at=Oe,rt=Me,ot=Ie,lt=Be,ct=We,dt=je,ht=Le,ut=ze,mt=Ue,pt=qe,ft=He,gt=Ke,wt=Ye,yt=Ve;let vt=null;vt="CARLO_RPC"===window._MDNE_BACKEND_TYPE?e:"ELECTRON_IPC"===window._MDNE_BACKEND_TYPE?t:"EXTERNAL"===window._MDNE_BACKEND_TYPE?{...window._mdneExternalBackend}:n;const Ct=vt.nativeNotifyEditorDirty,xt=vt.nativeAlert,St=(vt.nativeAlertSync,vt.nativeConfirm),bt=vt.nativeConfirmSync,kt=vt.nativeFileOpenDialog,At=vt.nativeFileSaveDialog,Dt=vt.renderByMenneu,Et=vt.loadFile,Pt=vt.saveFile,Ft=vt.listDirectory,Rt=vt.listDesktopDirectory,Nt=vt.listHomeDirectory,$t=vt.fileExists,Tt=vt.pathJoin,_t=vt.getDirName,Ot=vt.getBaseName,Mt=vt.getStartupFile,It=vt.openURL,Bt=vt.openNewWindow,Wt=vt.rpc,jt=vt.carlo,Lt=(()=>{let e=Object.assign({},liyad.defaultConfig);return e.reservedNames=Object.assign({},e.reservedNames,{Template:"$concat"}),e=liyad.installCore(e),e=liyad.installArithmetic(e),e=liyad.installSequence(e),e=liyad.installConcurrent(e),e.stripComments=!0,e.returnMultipleRoot=!0,liyad.SExpressionAsync(e)})();Lt.setGlobals({});const zt=Lt,Ut=new class{runCommand(e){return zt(e)}};let qt=null;const Ht={AppName:"Markdown Editor",AceEditor:null,filePath:null,inputFormat:"md",fileChanged:!1,skipDropDialog:!1,invalidate:()=>{}};function Kt(){document.title=`${Ht.AppName} - ${Ht.fileChanged?"● ":""}${Ht.filePath||"(New file)"}`,document.getElementById("appIndicatorBar").innerText=`${Ht.fileChanged?"● ":""}${Ht.filePath||"(New file)"} | mode: ${Ht.inputFormat}`}const Yt=Ht,Vt=e=>{Yt.fileChanged=e,Ct&&Ct(e)},Gt=async e=>{xt?await xt(String(e)):alert(e)},Jt=async e=>St?await St(String(e)):confirm(e);function Xt(e){switch(e.lastIndexOf(".")>=0?e.toLowerCase().slice(e.lastIndexOf(".")):""){case".md":case".markdown":return"md";case".html":case".htm":return"html";case".lisp":case".lsx":return"lisp";case".tex":return"tex";case".latex":return"latex";case".css":return"css";case".less":return"less";case".sass":return"sass";case".scss":return"scss";case".json":return"json";case".json5":return"json5";case".js":case".mjs":case".cjs":return"js";case".jsx":return"jsx";case".ts":return"ts";case".tsx":return"tsx";case".svg":return"svg";case".xml":return"xml";case".yaml":case".yml":return"yaml";case".toml":return"toml";case".ini":return"ini";case".graphql":case".gql":return"graphql";case".proto":case".proto2":case".proto3":return"protobuf";case".sql":return"sql";case".cs":return"csharp";case".go":return"golang";case".rb":return"ruby";case".rs":return"rust";case".py":return"python";case".java":return"java";case".kt":return"kotlin";case".r":return"r";case".sh":return"sh";case".dockerfile":return"dockerfile";case".makefile":return"makefile";default:return e.toLowerCase().endsWith("dockerfile")?"dockerfile":e.toLowerCase().endsWith("makefile")?"makefile":"text"}}function Qt(e){switch(e){case"md":case"html":case"lisp":return!0;default:return!1}}function Zt(e){switch(e){case"md":return"ace/mode/markdown";case"html":return"ace/mode/html";case"lisp":return"ace/mode/lisp";case"tex":return"ace/mode/tex";case"latex":return"ace/mode/latex";case"css":return"ace/mode/css";case"less":return"ace/mode/less";case"sass":return"ace/mode/sass";case"scss":return"ace/mode/scss";case"json":return"ace/mode/json";case"json5":return"ace/mode/json5";case"js":return"ace/mode/javascript";case"jsx":return"ace/mode/jsx";case"ts":return"ace/mode/typescript";case"tsx":return"ace/mode/tsx";case"svg":return"ace/mode/svg";case"xml":return"ace/mode/xml";case"yaml":return"ace/mode/yaml";case"toml":return"ace/mode/toml";case"ini":return"ace/mode/ini";case"graphql":return"ace/mode/graphqlshema";case"protobuf":return"ace/mode/protobuf";case"sql":return"ace/mode/sql";case"csharp":return"ace/mode/csharp";case"golang":return"ace/mode/golang";case"ruby":return"ace/mode/ruby";case"rust":return"ace/mode/rust";case"python":return"ace/mode/python";case"java":return"ace/mode/java";case"kotlin":return"ace/mode/kotlin";case"r":return"ace/mode/r";case"sh":return"ace/mode/sh";case"dockerfile":return"ace/mode/dockerfile";case"makefile":return"ace/mode/makefile";case"text":return"ace/mode/text";default:return}}class ei extends React.Component{constructor(e){super(e),this.state={},this.editor=null,this.outerWrapRef=React.createRef()}componentDidMount(){this.editor=ace.edit(this.props.id),this.editor.setFontSize(this.props.fontSize),this.editor.setTheme("ace/theme/monokai"),this.editor.session.setMode("ace/mode/markdown"),this.editor.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Cmd-S"},exec:async e=>{if(Yt.filePath)try{const t=await Pt(e.getValue(),Yt.filePath);Yt.filePath=t.path,Yt.inputFormat=Xt(Yt.filePath),e.session.setMode(Zt(Yt.inputFormat)),e.session.getUndoManager().markClean(),Vt(!1),Kt()}catch(e){await Gt(e)}else this.props.onSaveAs({})}}),this.editor.on("change",(e=>{this.props.onChange&&this.props.onChange(e)})),this.editor.session.on("changeScrollTop",(e=>{this.props.onChangeScrollTop&&this.props.onChangeScrollTop(e,this.editor.session.getScreenLength()*this.editor.renderer.lineHeight)})),this.editor.session.on("changeScrollLeft",(e=>{this.props.onChangeScrollLeft&&this.props.onChangeScrollLeft(e)})),Yt.AceEditor=Yt.AceEditor||{},Yt.AceEditor[this.props.id]=this.editor}render(){return lsx`
        (div (@ (ref ${this.outerWrapRef})
                (className
                    ($concat "AceEditorOuterWrap"
                             ${this.props.stretched?" stretched":""}
                             ${this.props.collapsed?" collapsed":""} )))
            (div (@ (id ${this.props.id})
                    (className "AceEditorDiv") )))`}}var ti=i(241);class ii extends React.Component{constructor(e){super(e),this.dialogRef=React.createRef()}showModal(e,t){this.options=e,this.handler=t,Yt.skipDropDialog?this.handleOnOpenDialogClick(null):(this.dialogRef.current.showModal(),document.activeElement.blur())}openFile(e,t){Yt.filePath=e,Yt.inputFormat=Xt(Yt.filePath),Vt(!1),Kt();const i=Yt.AceEditor[this.options.aceId];i.clearSelection(),i.session.setMode(Zt(Yt.inputFormat)),i.setValue(t),i.clearSelection(),i.session.getUndoManager().markClean(),i.moveCursorTo(0,0)}openFileAndClose(e,t){this.openFile(e,t),document.activeElement.blur(),this.dialogRef.current.close(),this.handler()}handleOnDragOver(e){e.stopPropagation(),e.preventDefault()}async handleOnDrop(e){try{e.preventDefault();const t=[];for(let i=0;i<e.dataTransfer.files.length;i++){t.push(jt.fileInfo(e.dataTransfer.files[i]));break}const i=await Promise.all(t),n=await Promise.all(i.map((e=>e.fileBodyText?Promise.resolve(e.fileBodyText):Et(e.path))));this.openFileAndClose(i[0].path,n[0])}catch(e){await Gt(e),Yt.filePath=null,Vt(!1),Kt()}}async handleOnOpenDialogClick(e){e&&this.handleCancelClick(e);try{this.options.fileOpenDialog.showModal({title:"Open",currentAceId:this.options.aceId,currentFilePath:Yt.filePath,fileTypes:ti.openFilter},(async(e,t)=>{const i=await Tt(e,t),n=await Et(i);this.openFileAndClose(i,n)}))}catch(e){await Gt(e),Yt.filePath=null,Vt(!1),Kt()}}handleCancelClick(e){document.activeElement.blur(),this.dialogRef.current.close()}render(){return lsx`
        (dialog (@ (ref ${this.dialogRef})
                   (style (backgroundColor "#333")
                          (color "white") ))
            (h5 "Open file")
            (div (@ (style (width "80vw")
                           (height "70vh")
                           (display "table-cell")
                           (textAlign "center")
                           (verticalAlign "middle") )
                    (onDragOver ${e=>{this.handleOnDragOver(e)}})
                    (onDragLeave ${()=>{}})
                    (onDrop ${async e=>{await this.handleOnDrop(e)}}) )
                (i (@ (className "material-icons large")) "insert_drive_file")(br)
                "Drop file here." (br)(br)(br)
                (a (@ (style (cursor "pointer")
                             (color "white")
                             (border-bottom "1px solid white") )
                      (onClick ${e=>{this.handleOnOpenDialogClick(e)}}) )
                      "Or click here to open the file dialog." ))
            (div (@ (style (display "flex")
                           (justifyContent "center") ))
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn grey darken-3")
                           (onClick ${e=>this.handleCancelClick(e)}) )
                    (i (@ (className "material-icons large")) "cancel")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "Cancel") )))`}}class ni extends React.Component{constructor(e){super(e),this.state={},this.state.title="",this.state.currentFilePath="",this.state.fileTypes=[],this.state.selectedFileType="*",this.state.currentDir="",this.state.currentDirFiles=[],this.state.inputFileName="",this.dialogRef=React.createRef(),this.fileNameInputRef=React.createRef(),this.fileTypeSelectorRef=React.createRef()}showModal(e,t){this.setState({title:e.title}),this.setState({currentFilePath:e.currentFilePath}),this.setState({fileTypes:e.fileTypes});let i=e.fileTypes[0];this.setState({selectedFileType:i.value}),this.setState({currentDir:""}),this.setState({currentDirFiles:[]}),this.setState({inputFileName:""}),this.options=e,this.handler=t,kt?(async()=>{const t=await kt(e.title,e.currentFilePath,e.fileTypes.map((e=>({name:e.text,extensions:e.exts&&e.exts.length>0?e.exts.map((e=>e.slice(1))):["*"],mime:e.mime}))));t&&this.handler(await _t(t[0]),await Ot(t[0]))})():(this.dialogRef.current.showModal(),document.activeElement.blur(),Ft(e.currentFilePath).then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Rt().then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Nt().then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Gt(e)}))}))})))}handleFileListItemClick(e,t,i){i?(this.fileNameInputRef.current.focus(),this.setState({inputFileName:""}),Ft(this.state.currentDir,t).then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Gt(e)}))):(this.fileNameInputRef.current.focus(),this.setState({inputFileName:t}))}async handleOkClick(e){try{if(""===this.state.inputFileName.trim())return;let e=this.state.inputFileName;if(!await $t(this.state.currentDir,e))return void await Gt("File does not exist.");this.handler(this.state.currentDir,e),document.activeElement.blur(),this.dialogRef.current.close()}catch(e){await Gt(e)}}getFilteredCurrentDirFiles(){return this.state.currentDirFiles.filter((e=>{if(e.isDirectory)return!0;let t=e.name;const i=t.lastIndexOf(".")>=0?t.toLowerCase().slice(t.lastIndexOf(".")):"";let n=this.options.fileTypes.filter((e=>e.value===this.state.selectedFileType))[0];return!n||!n.exts||0===n.exts.length||n.exts.filter((e=>e===i))[0]}))}handleCancelClick(e){document.activeElement.blur(),this.dialogRef.current.close()}render(){return lsx`
        (dialog (@ (ref ${this.dialogRef})
                   (style (backgroundColor "#333")
                          (color "white") ))
            (h5 ${this.state.title})
            (div ${this.state.currentDir})
            (div (@ (style (width "80vw")
                           (height "70vh")
                           (display "table-cell")
                           (textAlign "center") ))
                (div (@ (style (color "black")
                               (text-align "left")
                               (height "calc(100% - 100px)")
                               (overflow-x "auto")
                               (overflow-y "scroll") ))
                    (ul (@ (className "collection")
                           (style (margin "0")) )
                        ($=for ${this.getFilteredCurrentDirFiles()}
                            (li (@ (key $index)
                                   (className "collection-item"))
                                (a (@ (onClick (|-> (ev) use ($data)
                                          (${(e,t,i)=>this.handleFileListItemClick(e,t,i)}
                                              ev ::$data:name ::$data:isDirectory )))
                                      (style (cursor "pointer")
                                             (color "inherit")
                                             (text-decoration "none") ))
                                    (i (@ (className "material-icons tiny")
                                          (style (margin "0 10px 10px 10px")) )
                                        ($if ::$data:isDirectory "folder" "insert_drive_file") )
                                    ::$data:name )) )))
                (div (@ (className "row"))
                    (div (@ (className "input-field col s10"))
                        (label "File name")
                        (input (@ (ref ${this.fileNameInputRef})
                                  (style (color "white"))
                                  (type "text")
                                  (spellcheck "false")
                                  (readonly "readonly")
                                  (onChange ${()=>this.setState({inputFileName:this.fileNameInputRef.current.value})})
                                  (value ${this.state.inputFileName}) )))
                    (div (@ (className "input-field col s2"))
                        (select (@ (ref ${this.fileTypeSelectorRef})
                                   (className "browser-default")
                                   (onChange ${()=>this.setState({selectedFileType:this.fileTypeSelectorRef.current.value})}) )
                            ($=for ${this.state.fileTypes}
                                (option (@ (key   ::$data:value)
                                           (value ::$data:value)
                                           (($if (== ${this.state.selectedFileType} ::$data:value)
                                               "selected" "data-x-no-selected" )))
                                    ::$data:text ))))))
            (div (@ (style (display "flex")
                           (justifyContent "center") ))
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn grey darken-3")
                           (onClick ${e=>this.handleCancelClick(e)}) )
                    (i (@ (className "material-icons large")) "cancel")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "Cancel") )
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn blue darken-2")
                           (onClick ${e=>this.handleOkClick(e)}) )
                    (i (@ (className "material-icons large")) "check")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "OK") ) ))`}}class si extends React.Component{constructor(e){super(e),this.state={},this.state.title="",this.state.currentFilePath="",this.state.fileTypes=[],this.state.selectedFileType="*",this.state.currentDir="",this.state.currentDirFiles=[],this.state.inputFileName="",this.dialogRef=React.createRef(),this.fileNameInputRef=React.createRef(),this.fileTypeSelectorRef=React.createRef()}showModal(e,t){this.setState({title:e.title}),this.setState({currentFilePath:e.currentFilePath}),this.setState({fileTypes:e.fileTypes});const i=e.currentFilePath&&e.currentFilePath.lastIndexOf(".")>=0?e.currentFilePath.toLowerCase().slice(e.currentFilePath.lastIndexOf(".")):"";let n=e.fileTypes.filter((e=>e.exts.filter((e=>e===i))[0]))[0],s=e.fileTypes.filter((e=>"*"===e.value))[0];this.setState({selectedFileType:e.forExport?e.fileTypes[0].value:n?n.value:""!==i?s.value:e.fileTypes[0].value}),this.setState({currentDir:""}),this.setState({currentDirFiles:[]}),this.setState({inputFileName:""}),this.options=e,this.handler=t,At?(async()=>{const t=await At(e.title,e.currentFilePath,e.fileTypes.map((e=>({name:e.text,extensions:e.exts&&e.exts.length>0?e.exts.map((e=>e.slice(1))):["*"],mime:e.mime}))),e.intent);t&&this.handler(await _t(t),await Ot(t))})():(this.dialogRef.current.showModal(),document.activeElement.blur(),Ft(e.currentFilePath).then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Rt().then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Nt().then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Gt(e)}))}))})),Ot(e.currentFilePath).then((e=>{this.fileNameInputRef.current.focus(),this.setState({inputFileName:e})})).catch((e=>{})))}handleFileListItemClick(e,t,i){i?(this.fileNameInputRef.current.focus(),Ft(this.state.currentDir,t).then((e=>{this.setState({currentDir:e.directory}),this.setState({currentDirFiles:e.files})})).catch((e=>{Gt(e)}))):(this.fileNameInputRef.current.focus(),this.setState({inputFileName:t}))}async handleOkClick(e){try{if(""===this.state.inputFileName.trim())return;let e=this.state.inputFileName;const t=e.lastIndexOf(".")>=0?e.toLowerCase().slice(e.lastIndexOf(".")):"";let i=this.options.fileTypes.filter((e=>e.value===this.state.selectedFileType))[0];if(""===t&&i?e+=i.exts[0]||"":i.exts.filter((e=>e===t))[0]||(e+=i.exts[0]||""),await $t(this.state.currentDir,e)&&!await Jt("Are you sure want to overwrite the existing file?"))return;this.handler(this.state.currentDir,e),document.activeElement.blur(),this.dialogRef.current.close()}catch(e){await Gt(e)}}getFilteredCurrentDirFiles(){return this.state.currentDirFiles.filter((e=>{if(e.isDirectory)return!0;let t=e.name;const i=t.lastIndexOf(".")>=0?t.toLowerCase().slice(t.lastIndexOf(".")):"";let n=this.options.fileTypes.filter((e=>e.value===this.state.selectedFileType))[0];return!n||!n.exts||0===n.exts.length||n.exts.filter((e=>e===i))[0]}))}handleCancelClick(e){document.activeElement.blur(),this.dialogRef.current.close()}render(){return lsx`
        (dialog (@ (ref ${this.dialogRef})
                   (style (backgroundColor "#333")
                          (color "white") ))
            (h5 ${this.state.title})
            (div ${this.state.currentDir})
            (div (@ (style (width "80vw")
                           (height "70vh")
                           (display "table-cell")
                           (textAlign "center") ))
                (div (@ (style (color "black")
                               (text-align "left")
                               (height "calc(100% - 100px)")
                               (overflow-x "auto")
                               (overflow-y "scroll") ))
                    (ul (@ (className "collection")
                           (style (margin "0")) )
                        ($=for ${this.getFilteredCurrentDirFiles()}
                            (li (@ (key $index)
                                   (className "collection-item"))
                                (a (@ (onClick (|-> (ev) use ($data)
                                          (${(e,t,i)=>this.handleFileListItemClick(e,t,i)}
                                              ev ::$data:name ::$data:isDirectory )))
                                      (style (cursor "pointer")
                                             (color "inherit")
                                             (text-decoration "none") ))
                                    (i (@ (className "material-icons tiny")
                                          (style (margin "0 10px 10px 10px")) )
                                        ($if ::$data:isDirectory "folder" "insert_drive_file") )
                                    ::$data:name )) )))
                (div (@ (className "row"))
                    (div (@ (className "input-field col s10"))
                        (label "File name")
                        (input (@ (ref ${this.fileNameInputRef})
                                  (style (color "white"))
                                  (type "text")
                                  (spellcheck "false")
                                  (onChange ${()=>this.setState({inputFileName:this.fileNameInputRef.current.value})})
                                  (value ${this.state.inputFileName}) )))
                    (div (@ (className "input-field col s2"))
                        (select (@ (ref ${this.fileTypeSelectorRef})
                                   (className "browser-default")
                                   (onChange ${()=>this.setState({selectedFileType:this.fileTypeSelectorRef.current.value})}) )
                            ($=for ${this.state.fileTypes}
                                (option (@ (key   ::$data:value)
                                           (value ::$data:value)
                                           (($if (== ${this.state.selectedFileType} ::$data:value)
                                               "selected" "data-x-no-selected" )))
                                    ::$data:text ))))))
            (div (@ (style (display "flex")
                           (justifyContent "center") ))
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn grey darken-3")
                           (onClick ${e=>this.handleCancelClick(e)}) )
                    (i (@ (className "material-icons large")) "cancel")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "Cancel") )
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn blue darken-2")
                           (onClick ${e=>this.handleOkClick(e)}) )
                    (i (@ (className "material-icons large")) "check")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "OK") ) ))`}}class ai extends React.Component{constructor(e){super(e),this.state={},this.state.showFields=!1,this.state.fontFamily=void 0,this.state.fontSize=14,this.state.useSoftTabs=!0,this.state.tabSize=4,this.state.wrap=!1,this.state.showInvisibles=!1,this.state.darkThemePreview=!1,this.state.theme="monokai",this.state.enableSnippets=!1,this.dialogRef=React.createRef()}showModal(e,t){this.dialogRef.current.showModal(),document.activeElement.blur(),this.options=e,this.handler=t,this.setState({showFields:!1,fontFamily:e.editor.fontFamily,fontSize:e.editor.fontSize>0?e.editor.fontSize:14,useSoftTabs:!!e.editor.useSoftTabs,tabSize:e.editor.tabSize,wrap:"off"!==e.editor.wrap&&"free"===e.editor.wrap,showInvisibles:!!e.editor.showInvisibles,theme:(e.editor.theme||"").replace("ace/theme/",""),enableSnippets:!!e.editor.enableSnippets,darkThemePreview:!!e.renderer.darkThemePreview,skipDropDialog:!!e.app.skipDropDialog}),setTimeout((()=>this.setState({showFields:!0})),30)}componentDidUpdate(){M.updateTextFields();const e=document.querySelectorAll("select");M.FormSelect.init(e,{})}handleFontFamilyChange(e){this.setState({fontFamily:""===(e.target.value||"").trim()?null:e.target.value})}handleFontSizeChange(e){this.setState({fontSize:e.target.value})}handleTabSizeChange(e){this.setState({tabSize:Math.floor(Number(e.target.value))})}handleSoftTabsChange(e){this.setState({useSoftTabs:e.target.checked})}handleWrapChange(e){this.setState({wrap:e.target.checked})}handleShowInvisiblesChange(e){this.setState({showInvisibles:e.target.checked})}handleEnableSnippetsChange(e){this.setState({enableSnippets:e.target.checked})}handleDarkThemePreviewChange(e){this.setState({darkThemePreview:e.target.checked})}handleSkipDropDialogChange(e){this.setState({skipDropDialog:e.target.checked})}handleThemeChange(e){this.setState({theme:e.target.value})}handleOkClick(e){document.activeElement.blur(),this.dialogRef.current.close();const t=Number(this.state.fontSize);this.handler({editor:{fontFamily:this.state.fontFamily,fontSize:t>0?t:14,useSoftTabs:this.state.useSoftTabs,tabSize:this.state.tabSize>0?this.state.tabSize:4,wrap:this.state.wrap,showInvisibles:this.state.showInvisibles,theme:`ace/theme/${this.state.theme}`,enableBasicAutocompletion:this.state.enableSnippets,enableSnippets:this.state.enableSnippets,enableLiveAutocompletion:this.state.enableSnippets},renderer:{darkThemePreview:this.state.darkThemePreview},app:{skipDropDialog:this.state.skipDropDialog}})}handleCancelClick(e){document.activeElement.blur(),this.dialogRef.current.close()}render(){return lsx`
        (dialog (@ (ref ${this.dialogRef})
                   (className "appSettingsDialog-root")
                   (style (backgroundColor "#333")
                          (color "white") ))
            (style (@ (dangerouslySetInnerHTML """$concat
                .appSettingsDialog-root .select-wrapper input {
                    color: white;
                }
                .appSettingsDialog-root .select-wrapper svg.caret {
                    fill: white;
                }
                """) ))
            (h5 "Settings")
            (div (@ (style (width "80vw")
                           (height "70vh")
                           (display "table-cell")
                           (textAlign "center")
                           (paddingTop "20px") ))
                ($if ${this.state.showFields} (form
                    (div (@ (className "row")
                            (style (margin "0")) )
                        (div (@ (className "input-field col s12"))
                            (input (@ (id "appSettingsDialog-fontFamily")
                                      (type "text")
                                      (className "validate")
                                      (style (color "white"))
                                      (value ${this.state.fontFamily})
                                      (onChange ${e=>this.handleFontFamilyChange(e)}) ))
                            (label (@ (for "appSettingsDialog-fontFamily"))
                                "Font family (e.g. Consolas, 'Migu 1M', monospace)") ))
                    (div (@ (className "row")
                            (style (margin "0")) )
                        (div (@ (className "input-field col s2"))
                            (input (@ (id "appSettingsDialog-fontSize")
                                      (type "number")
                                      (className "validate")
                                      (style (color "white"))
                                      (value ${this.state.fontSize})
                                      (onChange ${e=>this.handleFontSizeChange(e)}) ))
                            (label (@ (for "appSettingsDialog-fontSize"))
                                "Font size (in points)") ))
                    (div (@ (className "row")
                            (style (margin "0")) )
                        (div (@ (className "input-field col s2"))
                            (input (@ (id "appSettingsDialog-tabSize")
                                      (type "number")
                                      (className "validate")
                                      (style (color "white"))
                                      (value ${this.state.tabSize})
                                      (onChange ${e=>this.handleTabSizeChange(e)}) ))
                            (label (@ (for "appSettingsDialog-tabSize"))
                                "Tab size") )
                        (div (@ (className "input-field col s4"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.useSoftTabs?"checked":""})
                                          (onChange ${e=>this.handleSoftTabsChange(e)}) ))
                                (span "Soft tabs") )))
                    (div (@ (className "row")
                            (style (margin "0")) )
                        (div (@ (className "input-field col s3"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.wrap?"checked":""})
                                          (onChange ${e=>this.handleWrapChange(e)}) ))
                                (span "Wrap") ))
                        (div (@ (className "input-field col s3"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.showInvisibles?"checked":""})
                                          (onChange ${e=>this.handleShowInvisiblesChange(e)}) ))
                                (span "Show Invisibles") ))
                        (div (@ (className "input-field col s3"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.enableSnippets?"checked":""})
                                          (onChange ${e=>this.handleEnableSnippetsChange(e)}) ))
                                (span "Enable Snippets") ))
                        (div (@ (className "input-field col s3"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.darkThemePreview?"checked":""})
                                          (onChange ${e=>this.handleDarkThemePreviewChange(e)}) ))
                                (span "Preview in dark theme") )))
                    (div (@ (className "row")
                            (style (margin "0")) )
                        (div (@ (className "input-field col s3"))
                            (label
                                (input (@ (type "checkbox")
                                          (className "filled-in")
                                          (checked ${this.state.skipDropDialog?"checked":""})
                                          (onChange ${e=>this.handleSkipDropDialogChange(e)}) ))
                                (span "Skip file drop dialog") )))
                    (div (@ (className "row")
                            (style (margin "40px 0 0 0")
                                   (color "white") ))
                        (div (@ (className "input-field col s12"))
                            (select (@ (id "appSettingsDialog-theme")
                                       (onChange ${e=>this.handleThemeChange(e)}) )
                                (option (@ (value "monokai")
                                           (selected ${"monokai"===this.state.theme?"selected":""})) "Monokai")
                                (option (@ (value "cobalt")
                                           (selected ${"cobalt"===this.state.theme?"selected":""})) "Cobalt")
                                (option (@ (value "terminal")
                                           (selected ${"terminal"===this.state.theme?"selected":""})) "Terminal")
                                (option (@ (value "tomorrow_night_bright")
                                           (selected ${"tomorrow_night_bright"===this.state.theme?"selected":""})) "Tomorrow Night Bright")
                                (option (@ (value "chrome")
                                           (selected ${"chrome"===this.state.theme?"selected":""})) "Chrome")
                                (option (@ (value "kuroir")
                                           (selected ${"kuroir"===this.state.theme?"selected":""})) "Kuroir")
                                (option (@ (value "textmate")
                                           (selected ${"textmate"===this.state.theme?"selected":""})) "Textmate") )
                            (label (@ (for "appSettingsDialog-theme"))
                                "Theme") )) )))
            (div (@ (style (display "flex")
                           (justifyContent "center") ))
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn grey darken-3")
                           (onClick ${e=>this.handleCancelClick(e)}) )
                    (i (@ (className "material-icons large")) "cancel")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "Cancel") )
                (button (@ (style (textTransform "none")
                                  (margin "0 3px 0 3px")
                                  (width "9em") )
                           (className "btn blue darken-2")
                           (onClick ${e=>this.handleOkClick(e)}) )
                    (i (@ (className "material-icons large")) "check")
                    (span (@ (style (margin "0 10px 10px 10px")
                                    (display "inline-block")
                                    (vertical-align "middle") )) "OK") ) ))`}}const ri=async(e,t,i,n,...s)=>await Dt(e,i,Object.assign({inputFormat:"md",dataFormat:"object"},t||{}),n,...s),oi=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");function li({app:e}){return[{name:"new-window",fn:(e,t)=>(...e)=>(Bt(),"")},{name:"open",fn:(t,i)=>async t=>{if(t){const i=Yt.filePath?await _t(Yt.filePath):null,n=await Tt(i,t),s=await Et(n);return e.fileDropDialogRef.current.openFile(n,s),e.afterFileOpen(),""}return e.handleFileOpenClick({}),""}},{name:"save",fn:(t,i)=>(...t)=>(e.handleSaveClick({}),"Saving...")},{name:"saveas",fn:(t,i)=>async t=>{if(t){const i=Yt.filePath?await _t(Yt.filePath):null;return await e.fileSaveAs(i,t),"Saved."}return e.handleSaveAsClick({}),""}},{name:"export",fn:(t,i)=>async t=>{if(!Qt(Yt.inputFormat))throw new Error(`Exporting of ${Yt.inputFormat} format is not supported.`);if(t){const i=Yt.filePath?await _t(Yt.filePath):null;return await e.fileExport(i,t),"Exported."}return e.handleExportClick({}),""}},{name:"preview",fn:(t,i)=>(...t)=>(e.handleShowClick({}),"")},{name:"sync",fn:(t,i)=>t=>(e.setState({syncPreview:"on"===t||!0===t}),"")},{name:"preview-format",fn:(t,i)=>t=>(e.setState({isPdf:"pdf"===t}),"")},{name:"scripting",fn:(t,i)=>t=>(e.setState({useScripting:"on"===t||!0===t}),"")},{name:"entire-text",fn:(t,i)=>t=>e.getEntireText(t)},{name:"selected-text",fn:(t,i)=>t=>e.getSelectedText(t)},{name:"insert",fn:(t,i)=>t=>e.insertText(t)},{name:"$>",fn:(e,t)=>(...e)=>qt.runCommandAST([[{symbol:"$>"},e.join(" ")]])},{name:"help",fn:(e,t)=>e=>(It("https://github.com/shellyln/mdne"),"")}]}function ci({getCurrentAceId:e}){return[{name:"mode",fn:(t,i)=>t=>{if(!t)throw new Error("Editor mode name is not specified.");Yt.inputFormat=t;const i=Zt(t);if(i)return Yt.AceEditor[e()].session.setMode(i),Kt(),Yt.invalidate(),"";throw new Error("Invalid editor mode name: "+t)}}]}function di({getCurrentAceId:e}){return[{name:"md",fn:(t,i)=>(...t)=>{switch(t[0]){case"table":{const i=Math.max(1,Number(t[1]||3)),n=Math.max(1,Number(t[2]||3));let s=`\n|${Array(n).fill("").map(((e,t)=>`R_C${t}`)).join("|")}|\n|${Array(n).fill("").map(((e,t)=>"----")).join("|")}|\n`;for(let e=0;e<i;e++)s+=`|${Array(n).fill("").map(((t,i)=>`R${e}C${i}`)).join("|")}|\n`;const a=Yt.AceEditor[e()];a.session.insert(a.getCursorPosition(),s)}return"";case"list":{const i=Math.max(1,Number(t[1]||3));let n="\n";for(let e=0;e<i;e++)n+=`* item ${e}\n`;const s=Yt.AceEditor[e()];s.session.insert(s.getCursorPosition(),n)}return"";case"o-list":{const i=Math.max(1,Number(t[1]||3));let n="\n";for(let e=0;e<i;e++)n+=`1. item ${e}\n`;const s=Yt.AceEditor[e()];s.session.insert(s.getCursorPosition(),n)}return"";case"checkbox":{const i=Math.max(1,Number(t[1]||3));let n="\n";for(let e=0;e<i;e++)n+=`* [${e%2==0?"X":" "}] item ${e}\n`;const s=Yt.AceEditor[e()];s.session.insert(s.getCursorPosition(),n)}return"";case"blockquote":case"quote":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n> This is blockquote.\n>> This is blockquote.\n")}return"";case"link":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n[This is inline-style link with title](https://github.com/shellyln/mdne "mdne")\n')}return"";case"image":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n![alt text](https://shellyln.github.io/assets/image/mdne-logo.svg "Logo" =300x100)\n')}return"";case"toc":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n[[TOC]]\n")}return"";case"hr":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n----\n")}return"";case"math":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n$$$\nsum_(i=1)^n i^3=((n(n+1))/2)^2\n$$$\n")}return"";case"inline-math":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," $$sum_(i=1)^n i^3=((n(n+1))/2)^2$$ ")}return"";case"mathjax":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" crossorigin="anonymous"><\/script>\n')}return"";case"code":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n```javascript\n\nconst x = 0;\n\n```\n")}return"";case"inline-code":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," `const x = 0` ")}return"";case"uml":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n@startuml\nAlice -> Bob: Authentication Request\nBob --\x3e Alice: Authentication Response\n\nAlice -> Bob: Another authentication Request\nAlice <-- Bob: Another authentication Response\n@enduml\n")}return"";case"emoji":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," :wink: :crush: :cry: :tear: :laughing: :yum: ")}return"";case"italic":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," *This is italic* ")}return"";case"italic-alt":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," _This is italic_ ")}return"";case"bold":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," **This is bold** ")}return"";case"bold-alt":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," __This is bold__ ")}return"";case"strikethrough":case"strikethru":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," ~~This is strikethrough~~ ")}return"";case"mark":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," ==This is mark== ")}return"";case"ins":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition()," ++This is ins++ ")}return"";case"footnote":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\nThis is footnote 1 link[^first].\n[^first]: Footnote text.\n")}return"";case"inline-footnote":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\nThis is inline footnote^[Text of inline footnote.].\n")}return"";case"deflist":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\nTerm 1\n    ~ Definition 1a\n    ~ Definition 1b\n")}return"";case"lazy-deflist":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\nTerm 1\n:   Definition 1a\nwith lazy continuation.\n\n    paragraph 1\n\n        { code block }\n    paragraph 3\n:   Definition 1b\n\n")}return"";case"abbr":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\nThis is HTML abbreviation example.\n*[HTML]: Hyper Text Markup Language\n")}return"";case"pagebreak":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n<div style="page-break-before:always"></div>\n')}return"";case"h1":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n# This is a header.\n")}return"";case"h1-no-toc":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n<p style="font-size: 2em; font-weight: bold; border-bottom: 1px solid #eaecef; padding-bottom: .3em;">This is a header.</p>\n')}return"";case"h2":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n## This is a header.\n")}return"";case"h2-no-toc":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n<p style="font-size: 1.5em; font-weight: bold; border-bottom: 1px solid #eaecef; padding-bottom: .3em;">This is a header.</p>\n')}return"";case"h3":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n### This is a header.\n")}return"";case"h4":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n#### This is a header.\n")}return"";case"h5":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n##### This is a header.\n")}return"";case"h6":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n###### This is a header.\n")}return"";case"style":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n<style>h4 { background-color: cyan; }</style>\n")}return"";case"comment":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n\x3c!-- This is a comment. --\x3e\n")}return"";case"char-entity-ref":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n&amp;&lt;&gt;&quot;&apos;&nbsp;\n&sup3;&frac34;&plusmn;&times;&divide;&para;&sect;&middot;&laquo;&raquo;\n&copy;&reg;&trade;&yen;&euro;$&curren;&pound;&cent;\n")}return"";case"escape":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"\n\\<style>h5 { background-color: cyan; }\\</style>\n")}return"";case"embedded-image":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n%%%(Image(@(src"https://shellyln.github.io/assets/image/mdne-logo.svg")(width 300)(height 100)(unit "px")(alt "Logo")))\n')}return"";case"embedded-uml":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n%%%(PlantUml """\nAlice -> Bob: Authentication Request\nBob --\x3e Alice: Authentication Response\n\nAlice -> Bob: Another authentication Request\nAlice <-- Bob: Another authentication Response\n""")\n')}return"";case"embedded-style":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n%%%(Style(@(src"https://shellyln.github.io/menneu/assets/style/playground.css")))\n')}return"";case"svg":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n%%%(Svg (@ (width 100)(height 100)(unit "mm"))\n\n)\n')}return"";case"canvas":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Canvas (-> (ctx) (::ctx@moveTo  10  10)\n                  (::ctx@lineTo 190 190)\n                  (::ctx:strokeStyle="rgba(255,128,0,0.2)")\n                  (::ctx@stroke)\n                  (::ctx@beginPath) ))\n')}return"";case"line":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Line (@(x 0)(y 0)(lineWidth 1)(stroke)(strokeColor "blue")(points ($list 10 10 20 40 30 90 ))))\n')}return"";case"rect":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Rect(@(x 5)(y 5)(width 70)(height 20)(lineWidth 3)(stroke)(strokeColor "blue")(fill)(fillColor "darkblue")))\n')}return"";case"roundrect":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(RoundRect(@(x 5)(y 5)(width 70)(height 20)(lineWidth 3)(r 3)(stroke)(strokeColor "blue")(fill)(fillColor "darkblue")))\n')}return"";case"qr":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Qr (@ (x 5)(y 7)(cellSize 0.8)(fill)(fillColor "darkblue")(data "Hello")))\n')}return"";case"code128":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Code128 (@ (x 5)(y 7)(elementWidth 0.66)(height 15)(quietHeight 0)(textHeight 7)\n            (font "7px \'OCRB\'")(fill)(fillColor "darkblue")(data "Hello") ))\n')}return"";case"code39":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Code39 (@ (x 5)(y 7)(narrowWidth 0.66)(wideWidth 1.32)(height 15)(quietHeight 0)(textHeight 7)\n           (font "7px \'OCRB\'")(fill)(fillColor "darkblue")(data "HELLO") ))\n')}return"";case"gtin13":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Gtin13 (@ (x 5)(y 7)(elementWidth 0.66)(height 15)(quietHeight 0)(textHeight 7)\n           (font "7px \'OCRB\'")(fill)(fillColor "darkblue")(data "123456789012") ))\n')}return"";case"gtin8":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'\n(Gtin8 (@ (x 5)(y 7)(elementWidth 0.66)(height 15)(quietHeight 0)(textHeight 7)\n          (font "7px \'OCRB\'")(fill)(fillColor "darkblue")(data "1234567") ))\n')}return"";case"print-preview":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),"<script>window.print()<\/script>")}return"";case"html5":{const t=Yt.AceEditor[e()];t.session.insert(t.getCursorPosition(),'(Html5\n(head (title "Untitled")\n      (meta (@ (charset "UTF-8")))\n      (NormalizeCss)\n      (PaperCss)\n\n    (style (@ (dangerouslySetInnerHTML """$concat\n        /* You can write additional styles here. */\n        /*\n        body {\n            background-color: blue;\n        }\n        */\n    """) )))\n\n(body (@ (class "A4"))\n    (section (@ (class "sheet padding-10mm"))\n        Hello!\n        )))\n')}return"";default:return""}}}]}const hi="_mdne_app_settings__Xlnuf3Ao",ui=JSON.stringify({version:2,editor:{},renderer:{},app:{}});class mi extends React.Component{constructor(e){super(e),this.state={},this.state.stretched=!0,this.state.syncPreview=!1,this.state.isPdf=!1,this.state.useScripting=!1,this.state.currentAceId="editor",this.state.splitterMoving=!1,this.state.darkThemePreview=!1,this.state.counter=0,this.aceFontSize=14,this.scheduleRerenderPreview=!1,this.savedEditorStyleWidth=null,this.savedPreviewScrollY=0,this.commandBoxRef=React.createRef(),this.editorRef=React.createRef(),this.editorPlaceholderRef=React.createRef(),this.splitterRef=React.createRef(),this.rootRef=React.createRef(),this.fileDropDialogRef=React.createRef(),this.fileOpenDialogRef=React.createRef(),this.fileSaveDialogRef=React.createRef(),this.settingsDialogRef=React.createRef(),Yt.invalidate=()=>this.setState({counter:this.state.counter+1}),window.onbeforeunload=e=>{if(!Yt.AceEditor[this.state.currentAceId].session.getUndoManager().isClean()&&!bt)return e.preventDefault(),""},zt.install((e=>{const t=()=>this.state.currentAceId,i=[...li({app:this}),...ci({getCurrentAceId:t}),...di({getCurrentAceId:t})];return e.funcs=(e.funcs||[]).concat(i),e}))}componentDidMount(){{const e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{constrainWidth:!1})}{const e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{})}{const e=document.querySelectorAll("select");M.FormSelect.init(e,{})}{const e=document.querySelectorAll(".command-box-input.autocomplete");M.Autocomplete.init(e,{data:Object.assign({"new-window":null,open:null,'open "path/to/file/opening"':null,save:null,saveas:null,'saveas "path/to/file/to/save/as"':null,export:null,'export "path/to/file/to/export"':null,preview:null,"sync on":null,"sync off":null,"preview-format pdf":null,"preview-format html":null,"scripting on":null,"scripting off":null,"entire-text":null,"selected-text":null,'insert "text"':null,"$resolve-pipe ($> ls -al) (<- insert) (-> () nil)":null,"$> some-shell-cmd cmd-options":null,help:null,"help topic-name":null},{"mode md":null,"mode html":null,"mode lisp":null,"mode tex":null,"mode latex":null,"mode css":null,"mode less":null,"mode sass":null,"mode scss":null,"mode json":null,"mode json5":null,"mode js":null,"mode jsx":null,"mode ts":null,"mode tsx":null,"mode svg":null,"mode xml":null,"mode yaml":null,"mode toml":null,"mode ini":null,"mode graphql":null,"mode protobuf":null,"mode sql":null,"mode csharp":null,"mode golang":null,"mode ruby":null,"mode rust":null,"mode python":null,"mode java":null,"mode kotlin":null,"mode r":null,"mode sh":null,"mode dockerfile":null,"mode makefile":null,"mode text":null},{"md table rows cols":null,"md list rows":null,"md o-list rows":null,"md checkbox rows":null,"md blockquote":null,"md link":null,"md image":null,"md toc":null,"md hr":null,"md math":null,"md inline-math":null,"md mathjax":null,"md code":null,"md inline-code":null,"md uml":null,"md emoji":null,"md italic":null,"md italic-alt":null,"md bold":null,"md bold-alt":null,"md strikethru":null,"md mark":null,"md ins":null,"md footnote":null,"md inline-footnote":null,"md deflist":null,"md lazy-deflist":null,"md abbr":null,"md pagebreak":null,"md h1":null,"md h1-no-toc":null,"md h2":null,"md h2-no-toc":null,"md h3":null,"md h4":null,"md h5":null,"md h6":null,"md style":null,"md comment":null,"md char-entity-ref":null,"md escape":null,"md embedded-image":null,"md embedded-uml":null,"md embedded-style":null,"md svg":null,"md canvas":null,"md line":null,"md rect":null,"md roundrect":null,"md qr":null,"md code128":null,"md code39":null,"md gtin13":null,"md gtin8":null,"md print-preview":null,"md html5":null})})}if(window.dialogPolyfill){const e=document.querySelectorAll("dialog");for(let t=0;t<e.length;t++){const i=e[t];dialogPolyfill.registerDialog(i)}}{var e,t,i,n;const s=window.localStorage.getItem(hi)||ui,a=JSON.parse(s);this.setState({darkThemePreview:null!==(e=null==a||null===(t=a.renderer)||void 0===t?void 0:t.darkThemePreview)&&void 0!==e&&e}),Yt.skipDropDialog=null!==(i=null==a||null===(n=a.app)||void 0===n?void 0:n.skipDropDialog)&&void 0!==i&&i,ace.config.loadModule("ace/ext/language_tools",(()=>{var e;Yt.AceEditor[this.state.currentAceId].setOptions({...JSON.parse(ui).editor,...null!==(e=a.editor)&&void 0!==e?e:{}})}))}document.onkeyup=e=>{e.ctrlKey&&e.shiftKey&&79===e.keyCode&&this.commandBoxRef.current.focus()};const s=()=>{Yt.inputFormat="md",Vt(!1),Kt();const e=Yt.AceEditor[this.state.currentAceId];e.clearSelection(),e.session.setMode(Zt(Yt.inputFormat)),e.setValue(""),e.clearSelection(),e.session.getUndoManager().markClean(),this.setState({counter:this.state.counter+1})};Mt().then((e=>{if(e){Yt.filePath=e.path,Yt.inputFormat=Xt(Yt.filePath),Vt(!1),Kt();const t=Yt.AceEditor[this.state.currentAceId];t.clearSelection(),t.session.setMode(Zt(Yt.inputFormat)),t.setValue(e.text),t.clearSelection(),t.session.getUndoManager().markClean(),t.moveCursorTo(0,0),this.setState({counter:this.state.counter+1})}else s(),Yt.skipDropDialog||this.openFileOpenDialog()})).catch((e=>{s(),Yt.skipDropDialog||this.openFileOpenDialog()}))}afterFileOpen(){this.rootRef.current.contentWindow.location.replace("empty.html"),this.setState({stretched:!0}),this.savedEditorStyleWidth=null,this.savedPreviewScrollY=0,this.editorRef.current.outerWrapRef.current.style.width=null,this.editorPlaceholderRef.current.style.width=null,document.activeElement.blur(),setTimeout((()=>{Yt.AceEditor[this.state.currentAceId].resize(!0)}),30)}openFileOpenDialog(){this.fileDropDialogRef.current.showModal({aceId:this.state.currentAceId,fileOpenDialog:this.fileOpenDialogRef.current},(()=>this.afterFileOpen()))}async handleFileOpenClick(e){(Yt.AceEditor[this.state.currentAceId].session.getUndoManager().isClean()||await Jt("Changes you made may not be saved.\nAre you sure want to discard changes?"))&&this.openFileOpenDialog()}handleStretchedClick(e){if(this.setState({stretched:!this.state.stretched}),this.state.stretched)this.editorRef.current.outerWrapRef.current.style.width=this.savedEditorStyleWidth,this.editorPlaceholderRef.current.style.width=this.savedEditorStyleWidth,setTimeout((()=>this.rootRef.current.contentWindow.scrollTo(this.rootRef.current.contentWindow.scrollX,this.savedPreviewScrollY)),30);else{try{this.savedEditorStyleWidth=this.editorRef.current.outerWrapRef.current.style.width,this.savedPreviewScrollY=this.rootRef.current.contentWindow.scrollY}catch(e){}this.editorRef.current.outerWrapRef.current.style.width=null,this.editorPlaceholderRef.current.style.width=null}document.activeElement.blur(),setTimeout((()=>{Yt.AceEditor[this.state.currentAceId].resize(!0)}),30)}handleSyncPreviewClick(e){this.setState({syncPreview:!this.state.syncPreview}),document.activeElement.blur()}handleIsPdfClick(e){this.setState({isPdf:!this.state.isPdf}),document.activeElement.blur()}handleUseScriptingClick(e){this.setState({useScripting:!this.state.useScripting}),document.activeElement.blur()}handleShowClick(e){this.state.stretched&&(this.editorRef.current.outerWrapRef.current.style.width=this.savedEditorStyleWidth,this.editorPlaceholderRef.current.style.width=this.savedEditorStyleWidth),this.state.isPdf&&(window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER||window._MDNE_BACKEND_CAPS_NO_PDF_PREVIEW_PLUGIN)||this.setState({stretched:!1});const t=Yt.AceEditor[this.state.currentAceId];Qt(Yt.inputFormat)?(this.state.isPdf?ri(t.getValue(),{inputFormat:Yt.inputFormat,outputFormat:"pdf",rawInput:!("md"!==Yt.inputFormat&&"html"!==Yt.inputFormat||this.state.useScripting)},null,Yt.filePath).then((e=>{this.rootRef.current.contentWindow.location.replace(e)})).catch((async e=>{console.error(e),this.rootRef.current.contentWindow.location.replace("error.html")})):ri(t.getValue(),{inputFormat:Yt.inputFormat,outputFormat:"html",rawInput:!("md"!==Yt.inputFormat&&"html"!==Yt.inputFormat||this.state.useScripting),darkTheme:!!this.state.darkThemePreview},null,Yt.filePath).then((e=>{this.rootRef.current.contentWindow.location.replace(e),setTimeout((()=>{var e,t;return this.rootRef.current.contentWindow.scrollTo(this.rootRef.current.contentWindow.scrollX,Math.min(this.savedPreviewScrollY,null!==(e=null===(t=this.rootRef.current.contentWindow.document.documentElement)||void 0===t?void 0:t.scrollHeight)&&void 0!==e?e:this.savedPreviewScrollY))}),30)})).catch((async e=>{console.error(e),this.rootRef.current.contentWindow.location.replace("error.html")})),setTimeout((()=>{Yt.AceEditor[this.state.currentAceId].resize(!0)}),30)):(console.error(`Preview of ${Yt.inputFormat} format is not supported.`),this.rootRef.current.contentWindow.location.replace("error.html")),document.activeElement.blur()}handleSaveClick(e){Yt.filePath?Yt.AceEditor[this.state.currentAceId].execCommand("save"):this.handleSaveAsClick(e)}async fileSaveAs(e,t){const i=Yt.AceEditor[this.state.currentAceId],n=await Pt(i.getValue(),e,t);Yt.filePath=n.path,Yt.inputFormat=Xt(Yt.filePath),i.session.setMode(Zt(Yt.inputFormat)),i.session.getUndoManager().markClean(),Vt(!1),Kt(),this.setState({counter:this.state.counter+1})}handleSaveAsClick(e){this.fileSaveDialogRef.current.showModal({title:"Save as",currentAceId:this.state.currentAceId,currentFilePath:Yt.filePath,forExport:!1,fileTypes:ti.saveAsFilter,intent:"saveas"},(async(e,t)=>{try{await this.fileSaveAs(e,t)}catch(e){await Gt(e)}}))}async fileExport(e,t){const i=Yt.AceEditor[this.state.currentAceId],n=t.lastIndexOf(".")>=0?t.toLowerCase().slice(t.lastIndexOf(".")):"";await ri(i.getValue(),{inputFormat:Yt.inputFormat,outputFormat:".pdf"===n?"pdf":"html",rawInput:!("md"!==Yt.inputFormat&&"html"!==Yt.inputFormat||this.state.useScripting)},null,Yt.filePath,e,t)}getEntireText(){return Yt.AceEditor[this.state.currentAceId].getValue()}getSelectedText(){return Yt.AceEditor[this.state.currentAceId].getSelectedText()}insertText(e){const t=Yt.AceEditor[this.state.currentAceId];return t.session.insert(t.getCursorPosition(),e),e}async handleExportClick(e){Qt(Yt.inputFormat)?this.fileSaveDialogRef.current.showModal({title:"Export",currentAceId:this.state.currentAceId,currentFilePath:Yt.filePath,forExport:!0,fileTypes:ti.exportFilter,intent:"export"},(async(e,t)=>{try{await this.fileExport(e,t)}catch(e){await Gt(e)}})):await Gt(`Preview of ${Yt.inputFormat} format is not supported.`)}handleSettingsClick(e){var t,i;const n=Yt.AceEditor[this.state.currentAceId],s=JSON.parse(window.localStorage.getItem(hi)||ui);this.settingsDialogRef.current.showModal({editor:n.getOptions(),renderer:null!==(t=s.renderer)&&void 0!==t?t:{},app:null!==(i=s.app)&&void 0!==i?i:{}},(e=>{var t,i,s;e.version=2,n.setOptions(e.editor),window.localStorage.setItem(hi,JSON.stringify(e)),this.setState({darkThemePreview:null!==(t=null==e||null===(i=e.renderer)||void 0===i?void 0:i.darkThemePreview)&&void 0!==t&&t}),Yt.skipDropDialog=null==e||null===(s=e.app)||void 0===s?void 0:s.skipDropDialog}))}handleAceEditorOnChange(e){if(!Yt.fileChanged){const e=Yt.AceEditor[this.state.currentAceId];if(!e.curOp||!e.curOp.command.name)return;Vt(!0),Kt()}if(!this.state.stretched&&this.state.syncPreview&&!this.state.isPdf){if(!Qt(Yt.inputFormat))return;this.scheduleRerenderPreview||(this.scheduleRerenderPreview=!0,setTimeout((()=>{const e=Yt.AceEditor[this.state.currentAceId];ri(e.getValue(),{inputFormat:Yt.inputFormat,outputFormat:"html",rawInput:!("md"!==Yt.inputFormat&&"html"!==Yt.inputFormat||this.state.useScripting),darkTheme:!!this.state.darkThemePreview},null,Yt.filePath).then((e=>{e.startsWith("data:")||e.startsWith("blob:")?this.rootRef.current.contentWindow.location.replace(e):this.rootRef.current.contentWindow.location.reload(!0),this.scheduleRerenderPreview=!1})).catch((e=>{this.scheduleRerenderPreview=!1,console.error(e)}))}),3e3))}}handleAceEditorOnChangeScrollTop(e,t){if(!this.state.stretched&&!this.state.isPdf)try{const i=e/t,n=this.rootRef.current.contentWindow.document.documentElement.scrollHeight*i;this.rootRef.current.contentWindow.scrollTo(this.rootRef.current.contentWindow.scrollX,n),this.savedPreviewScrollY=n}catch(e){}}handleAceEditorOnChangeScrollLeft(e){}handleCommandBoxOnKeyDown(e){const t=()=>{this.commandBoxRef.current.value="",M.Autocomplete.getInstance(document.querySelectorAll(".command-box-input.autocomplete")[0]).close()};if(13===e.keyCode)if(""===this.commandBoxRef.current.value.trim())t();else{const e=`(${this.commandBoxRef.current.value})`;zt(e).then((e=>{t(),"string"==typeof e&&""===e.trim()||null!=e&&(Array.isArray(e)&&0===e.length||M.toast({html:oi(String(e)).replace(/\r?\n/g,"<br>"),classes:"teal darken-4"}))})).catch((e=>{t(),M.toast({html:oi(String(e)),classes:"red darken-4"})}))}else 27===e.keyCode&&(t(),document.activeElement.blur())}handleCommandBoxOnBlur(e){M.Toast.dismissAll(),Yt.AceEditor[this.state.currentAceId].focus()}handleSplitterOnPointerDown(e){this.setState({splitterMoving:!0}),window.onpointermove=e=>{const t=Math.max(Math.min(e.clientX-5,window.innerWidth-440),400),i=`${Math.round(t/window.innerWidth*100)}%`;this.editorRef.current.outerWrapRef.current.style.width=i,this.editorPlaceholderRef.current.style.width=i},window.onpointerup=e=>{window.onpointermove=null,window.onpointerup=null,this.splitterRef.current.releasePointerCapture(e.pointerId),this.setState({splitterMoving:!1}),setTimeout((()=>{this.rootRef.current.contentWindow.scrollTo(this.rootRef.current.contentWindow.scrollX,this.savedPreviewScrollY),Yt.AceEditor[this.state.currentAceId].resize(!0)}),30)},this.splitterRef.current.setPointerCapture(e.pointerId)}render(){const e="BROWSER_EMULATION"===window._MDNE_BACKEND_TYPE,t=window.navigator.userAgent,i=t.match(" Chrome/")&&!t.match(" CriOS/")&&!t.match(" OPR/")&&!t.match(" Presto/")&&!t.match(" Vivaldi/")&&!t.match(" Iron Safari/")&&!t.match(" Sleipnir/")&&!t.match(" Mobile Safari/");return lsx`
        (Template
            (div (@ (className "AppMainMenuWrap"))
                (a (@ (className "AppMainMenu dropdown-trigger btn-floating")
                      (data-target "dropdown1") )
                    (i (@ (className "AppMainMenuIcon material-icons large")) "dehaze") )
                (ul (@ (id "dropdown1")
                       (className "dropdown-content") )
                    (MenuItem (@ (icon "add_box")
                                 (caption "New window")
                                 (onClick ${()=>{Bt()}}) ))
                    (MenuItem (@ (icon "folder_open")
                                 (caption "Open...")
                                 (onClick ${e=>this.handleFileOpenClick(e)}) ))
                    (MenuItem (@ (icon "save")
                                 (caption "Save (Ctrl+S)")
                                 (onClick ${e=>this.handleSaveClick(e)}) ))
                    (MenuItem (@ (icon "save")
                                 (caption "Save as...")
                                 (onClick ${e=>this.handleSaveAsClick(e)}) ))
                    (MenuItem (@ (icon "publish")
                                 (caption "Export...")
                                 (onClick ${e=>this.handleExportClick(e)}) ))
                    (MenuDivider)
                    (MenuItem (@ (icon "find_in_page")
                                 (caption "Find... (Ctrl+F)")
                                 (onClick ${()=>{Yt.AceEditor.editor.execCommand("find")}}) ))
                    (MenuDivider)
                    (MenuItem (@ (icon "settings")
                                 (caption "Settings...")
                                 (onClick ${e=>this.handleSettingsClick(e)}) ))
                    (MenuItem (@ (icon "help_outline")
                                 (caption "Help")
                                 (onClick ${()=>It("https://github.com/shellyln/mdne")}) )) )
                (Switch (@ (caption "Sync preview")
                           (offText "OFF")
                           (onText  "ON")
                           (elClass "hide-on-smallest")
                           (checked ${this.state.syncPreview})
                           (onClick ${e=>this.handleSyncPreviewClick(e)}) ))
                ($if ${!window._MDNE_BACKEND_CAPS_NO_PDF_RENDERER}
                    (Switch (@ (caption "Preview format")
                            (offText "HTML")
                            (onText  "PDF")
                            (elClass "hide-on-smallest")
                            (checked ${this.state.isPdf})
                            (onClick ${e=>this.handleIsPdfClick(e)}) )))
                (Switch (@ (caption "Scripting")
                           (offText "OFF")
                           (onText  "ON")
                           (elClass "hide-on-smallest")
                           (checked ${this.state.useScripting})
                           (onClick ${e=>this.handleUseScriptingClick(e)}) ))
                (span (@ (style (flexGrow "2"))) " ")
                (div (@ (className "row command-box-input-outer") )
                    (div (@ (className "input-field col s9 command-box-input-inner") )
                        (input (@ (ref ${this.commandBoxRef})
                                  (className "CommandBoxInput command-box-input autocomplete")
                                  (type "text")
                                  (placeholder ($concat
                                      "Command palette    (" ${e&&i?"Alt+Ctrl+Shift+O":"Ctrl+Shift+O"} ")" ))
                                  (spellcheck "false")
                                  (onBlur ${e=>this.handleCommandBoxOnBlur(e)})
                                  (onKeyDown ${e=>this.handleCommandBoxOnKeyDown(e)}) ))))
                (button (@ (style (textTransform "none")
                                  (margin "0 3px") )
                           (className "btn tooltipped")
                           (data-tooltip "Update preview")
                           (onClick ${e=>this.handleShowClick(e)}) )
                    (i (@ (className "material-icons")) "visibility") )
                (button (@ (style (textTransform "none")
                                  (margin "0 3px") )
                           (className "btn tooltipped")
                           (data-tooltip "Toggle preview")
                           (onClick ${e=>this.handleStretchedClick(e)}) )
                    (i (@ (className "material-icons")) "chrome_reader_mode") ))
            (div (@ (className "AppMainContentWrap"))
                (AceEditor (@ (ref ${this.editorRef})
                              (id "editor")
                              (stretched ${!!this.state.stretched})
                              (collapsed ${!!this.state.splitterMoving})
                              (fontSize ${this.aceFontSize})
                              (onSaveAs ${e=>this.handleSaveAsClick(e)})
                              (onChange ${e=>this.handleAceEditorOnChange(e)})
                              (onChangeScrollTop ${(e,t)=>this.handleAceEditorOnChangeScrollTop(e,t)})
                              (onChangeScrollLeft ${e=>this.handleAceEditorOnChangeScrollLeft(e)}) ))
                (div (@ (ref ${this.editorPlaceholderRef})
                        (className ($concat "AceEditorPlaceholder"
                                   ${this.state.splitterMoving?"":" collapsed"}) ) ))
                (div (@ (ref ${this.splitterRef})
                        (className ($concat "Splitter"
                                   ${this.state.stretched?" collapsed":""}))
                        (onPointerDown ${e=>this.handleSplitterOnPointerDown(e)}) ))
                (div (@ (className ($concat "OutputIframePlaceholder"
                                   ${this.state.splitterMoving?"":" collapsed"}) ) ))
                (iframe (@ (ref ${this.rootRef})
                           (src "empty.html")
                           (style (background-color ${this.state.darkThemePreview&&"md"===Yt.inputFormat?"#1b1f23":"white"}))
                           ; (sandbox "")
                           (className ($concat "OutputIframe"
                                      ${this.state.stretched||this.state.splitterMoving?" collapsed":""}) ) ))
                (div (@ (id "appIndicatorBar")
                        (className "AppIndicatorBar")) "") )
            (FileDropDialog (@ (ref ${this.fileDropDialogRef})))
            (FileOpenDialog (@ (ref ${this.fileOpenDialogRef})))
            (FileSaveDialog (@ (ref ${this.fileSaveDialogRef})))
            (SettingsDialog (@ (ref ${this.settingsDialogRef}))) )`}}const pi=liyad.LSX({jsx:React.createElement,jsxFlagment:React.Fragment,components:{AceEditor:ei,FileDropDialog:ii,FileOpenDialog:ni,FileSaveDialog:si,SettingsDialog:ai,MenuItem:({icon:e,caption:t,onClick:i})=>lsx`
        (li (a (@ (onClick ${i}))
            (i (@ (className "material-icons")) ${e})
            ${t} ))`,MenuDivider:()=>lsx`(li (@ (className "divider") (tabIndex -1)))`,Switch:({caption:e,offText:t,onText:i,elClass:n,checked:s,onClick:a})=>lsx`
        (div (@ (className ("switch" ${n||""})))
            (label ${e})(br)
            (label
                ${t}
                (input (@ (type "checkbox")
                          (checked ${s})
                          (onClick ${a}) ))
                (span  (@ (className "lever")))
                ${i} ))`,App:mi}});window.lsx=pi,(async()=>{await async function(){if(qt)return qt;qt=(await jt.loadParams())[0],await qt.setFrontend(Wt.handle(Ut))}(),ReactDOM.render(lsx`(App)`,document.getElementById("app"))})()})();
//# sourceMappingURL=index.js.map